set realname  = "Mi Yu"
set envelope_from

set folder = "~/.mail/"
set header_cache = "~/.cache/mutt/mutt"
set message_cachedir = "~/.cache/mutt/messages"

# behavior
set   wait_key      = no
set   mbox_type     = Maildir
set   sort          = threads
set   sort_aux      = reverse-last-date-received
set   sleep_time    = 0
set   date_format   = "%y-%m-%d %T"
set   index_format  = "%2C | %Z [%d] %-30.30F (%-4.4c) %s"
set   edit_headers  = yes
set   editor        = "nvim +/^$"
set   query_command = "abook --mutt-query '%s'"
set   include       = no                    # include message in replies
set   forward_quote = no                    # include message in forwards
set   fast_reply                            # skip to compose when replying
set   text_flowed                           # soft line breaks
set   reverse_name                          # reply as whomever it was to
unset record

# pager
set   pager_index_lines = 10    # number of index lines to show
set   pager_context = 3         # number of context lines to show
set   pager_stop                # don't go to next message automatically
set   menu_scroll               # scroll in menus
set   tilde                     # show tildes like in vim
unset markers                   # no ugly plus signs

# html mail
set mailcap_path = ~/.config/mutt/mailcap
auto_view text/html
alternative_order text/plain text/html

# gmail account
source "~/.config/mutt/muttrc.gmail"
folder-hook $folder "source ~/.config/mutt/muttrc.gmail"

# williams account
source "~/.config/mutt/muttrc.williams"
folder-hook $folder "source ~/.config/mutt/muttrc.williams"

# default mailbox
set spoolfile = "+williams/INBOX"
mailboxes +temporary/search

# bindings
bind editor       <Tab> complete-query
bind pager        k     previous-line
bind pager        j     next-line
bind pager        g     noop
bind pager        gg    top
bind pager        G     bottom

# macros
macro index       O     "<shell-escape>offlineimap<enter>"                     "run offlineimap to sync all mail"
macro index       o     "<shell-escape>offlineimap -qf INBOX<enter>"           "run offlineimap to sync inbox"
macro index,pager a     "<pipe-message>abook --add-email-quiet<return>"        "Add this sender to Abook"
macro pager       \Cl   "<pipe-entry>'urlview'<enter>"
macro compose     \;    "<filter-entry>pandoc -s -f markdown -t html5 --metadata pagetitle=\"mail\"<enter>y<edit-type>^Utext/html; charset=utf-8<enter><enter>" "convert to html email"
macro index       S     "<enter-command>unset wait_key<enter> \
                         <shell-escape>~/.config/mutt/mutt-notmuch.py ~/.mail/temporary/search<enter> \
                         <change-folder-readonly>+temporary/search<enter>" \
                                                                               "search mail (using notmuch)"

# sidebar
source "~/.config/mutt/muttrc.sidebar"

# color
source "~/.config/mutt/muttrc.color"
